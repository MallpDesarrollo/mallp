import React, { useRef, useEffect } from 'react';
import maplibregl from 'maplibre-gl';
import 'maplibre-gl/dist/maplibre-gl.css';
// import { geo } from "./assets/out.json"

const Map = () => {
  const mapContainer = useRef(null);
  // let ubicacionUsuario = null;

  useEffect(() => {
    const map = new maplibregl.Map({
      container: mapContainer.current,
      style: 'https://demotiles.maplibre.org/style.json', // Puedes usar otro estilo
      center: [-75.58777499661787, 6.263433865116909], // Coordenadas de tu centro comercial
      // center: [-75.5269632, 6.3176704 ], // Coordenadas de tu centro comercial
      zoom: 21, // Nivel de zoom inicial
    });

    map.on('load', () => {
      map.addSource('planos', {
        type: 'geojson',
        data: {"type":"FeatureCollection","features":[{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58778530111002,6.263452767665115],[-75.58776339222072,6.26347875249067]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58776339222072,6.26347875249067],[-75.58776319518286,6.263478588336611]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58775695565086,6.263473390147055],[-75.58776565314966,6.263463074562708]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58776565314966,6.263463074562708],[-75.58775961065608,6.263458040525904]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58775369952072,6.263453115924733],[-75.58773839624867,6.2634403666778695]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58773839624867,6.2634403666778695],[-75.58773946416945,6.263439100080774]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58775160763969,6.263424697435781],[-75.5877650062128,6.263435859866576]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58777715687957,6.263445982658894],[-75.58778530111002,6.263452767665115]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58775961065608,6.263458040525904],[-75.58775900513393,6.263458758699343]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877643251557,6.263463190840611],[-75.58775900513393,6.263458758699343]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58775623317906,6.2634727882515335],[-75.5877643251557,6.263463190840611]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58776278669853,6.263479470664038],[-75.58776258966068,6.263479306510064]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58778602358237,6.263453369561859],[-75.5877641146925,6.263479354386206]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877777624012,6.263445264485384],[-75.58778590663219,6.26345204949169]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877530939991,6.263453834098215],[-75.5877377907265,6.263441084851365]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58773767377684,6.263439764782262],[-75.58773874169766,6.263438498185224]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877522131613,6.263423979262242],[-75.58776488926262,6.263434539797487]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877522131613,6.263423979262242],[-75.58775149068951,6.263423377366678]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877370682547,6.263440482955772],[-75.5877377907265,6.263441084851365]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877530939991,6.263453834098215],[-75.58775369952072,6.263453115924733]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58775562765689,6.263473506425029],[-75.58775635012925,6.263474108320537]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58776278669853,6.263479470664038],[-75.58776350917034,6.2634800725596165]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58778602358237,6.263453369561859],[-75.58778662910397,6.263452651388334]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877641146925,6.263479354386206],[-75.58776350917034,6.2634800725596165]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877777624012,6.263445264485384],[-75.58777715687957,6.263445982658894]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58776561173441,6.263435141693009],[-75.5877650062128,6.263435859866576]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58775623317906,6.2634727882515335],[-75.58772785972997,6.263449150164561]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58775562765689,6.263473506425029],[-75.587726531736,6.26344926644137]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58773767377684,6.263439764782262],[-75.58773222239631,6.263435223205207]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58773222239631,6.263435223205207],[-75.58774543378736,6.263419553962933]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58775088516735,6.263424095540174],[-75.58774543378736,6.263419553962933]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58772785972997,6.263449150164561],[-75.58773595170662,6.263439552753212]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877370682547,6.263440482955772],[-75.58773595170662,6.263439552753212]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58773089440237,6.263435339483138],[-75.58774471131501,6.263418952067383]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58774531683719,6.263418233893802],[-75.58775149068951,6.263423377366678]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58772713725817,6.263448548267917],[-75.5877352292348,6.263438950857662]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877352292348,6.263438950857662],[-75.587726531736,6.26344926644137]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877352292348,6.263438950857662],[-75.58773089440237,6.263435339483138]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58773839624867,6.2634403666778695],[-75.58773946416945,6.263439100080774]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58773946416945,6.263439100080774],[-75.58773874169766,6.263438498185224]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58775051769992,6.263425990148988],[-75.58774979522755,6.2634253882533955]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58775051769992,6.263425990148988],[-75.58775160763969,6.263424697435781]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58774979522755,6.2634253882533955],[-75.58775088516735,6.263424095540174]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58778590663219,6.26345204949169],[-75.58779509955812,6.263441146311877]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58778602358237,6.263453369561859],[-75.58779582203047,6.26344174820747]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58779509955812,6.263441146311877],[-75.58778209506076,6.263430312188234]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58779563940118,6.263440373420025],[-75.58778270058293,6.263429594014738]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58779582203047,6.26344174820747],[-75.58779642755209,6.263441030033931]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58779509955812,6.263441146311877],[-75.5877813725884,6.263429710291547]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877813725884,6.263429710291547],[-75.58778197811057,6.263428992117994]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877650062128,6.263435859866576],[-75.58777458447081,6.263424499666584]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877650062128,6.263435859866576],[-75.58776428374044,6.26343525797094]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58776488926262,6.263434539797487],[-75.58774505412022,6.263418015022509]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58775424704613,6.263407111840891],[-75.58774505412022,6.263418015022509]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877535245738,6.263406509945256],[-75.58774433164785,6.2634174131269305]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877535245738,6.263406509945256],[-75.58775413009597,6.263405791771788]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58776488926262,6.263434539797487],[-75.58777386199847,6.2634238977710055]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58774505412022,6.263418015022509],[-75.58775832055822,6.2634022804910785]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58777815570062,6.263418805266468],[-75.58775832055822,6.2634022804910785]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58775759808589,6.263401678595443],[-75.58775413009597,6.263405791771788]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877787612228,6.263418087093015],[-75.5877589260804,6.263401562317512]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58777948369458,6.263418688988551],[-75.58777887817298,6.26341940716209]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58775820360805,6.263400960421876],[-75.58775759808589,6.263401678595443]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58774471131501,6.263418952067383],[-75.58774372612568,6.263418131300455]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58774372612568,6.263418131300455],[-75.58774433164785,6.2634174131269305]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877589260804,6.263401562317512],[-75.58777219251843,6.263385827786649]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58777386199847,6.2634238977710055],[-75.58777458447081,6.263424499666584]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58777815570062,6.263418805266468],[-75.58777887817298,6.26341940716209]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877813725884,6.263429710291547],[-75.58778197811057,6.263428992117994]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58779040037234,6.263419002976278],[-75.58778908678637,6.263417908620738]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877865539049,6.263425023818783],[-75.58778875580353,6.263422412278416]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877910058945,6.263418284802768],[-75.58778969230856,6.2634171904472]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58775820360805,6.263400960421876],[-75.58777207556824,6.263384507716353]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58779172836631,6.263418886698361],[-75.58779112284412,6.2634196048719275]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58777219251843,6.263385827786649],[-75.58778999160303,6.263400656310367]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58777207556824,6.263384507716353],[-75.58779020304952,6.2633996098297615]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58778999160303,6.263400656310367],[-75.58778926913125,6.2634000544147455]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58778872481346,6.263406269872789],[-75.58778310997191,6.263412929300841]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58778443796642,6.263412813022896],[-75.58779005280742,6.263406153594886]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58775695565086,6.263473390147055],[-75.58775715268872,6.263473554299978]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58775715268872,6.263473554299978],[-75.58775654716709,6.263474272473445]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58776339222072,6.26347875249067],[-75.58776319518286,6.263478588336611]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58776319518286,6.263478588336611],[-75.58776258966068,6.263479306510064]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58775715268872,6.263473554299978],[-75.58775695565086,6.263473390147055]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58775654716709,6.263474272473445],[-75.58775635012925,6.263474108320537]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877865539049,6.263425023818783],[-75.58778875580353,6.263422412278416]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58778872481346,6.263406269872789],[-75.58778668875573,6.2634045736205195]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58778668875573,6.2634045736205195],[-75.58778999160303,6.263400656310367]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58778933033507,6.263405551699293],[-75.5877880167497,6.263404457342631]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877880167497,6.263404457342631],[-75.58779071407542,6.263401258205988]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58779071407542,6.263401258205988],[-75.58779131959759,6.263400540032407]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58778933033507,6.263405551699293],[-75.58779005280742,6.263406153594886]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877787612228,6.263418087093015],[-75.58777948369458,6.263418688988551]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58778383244427,6.263413531196406],[-75.58778310997191,6.263412929300841]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58776258966068,6.263479306510064],[-75.58775654716709,6.263474272473445]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58778270058293,6.263429594014738],[-75.58778197811057,6.263428992117994]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58778583143312,6.2634244219232045],[-75.5877865539049,6.263425023818783]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58778583143312,6.2634244219232045],[-75.58779040037234,6.263419002976278]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877865539049,6.263425023818783],[-75.58778875580353,6.263422412278416]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58778875580353,6.263422412278416],[-75.58779578348641,6.263428267082446]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58779578348641,6.263428267082446],[-75.58779578348641,6.263428267082446]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5878009964913,6.263435611087203],[-75.58779642755209,6.263441030033931]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58779578348641,6.263428267082446],[-75.58779490272718,6.263429311698317]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58779490272718,6.263429311698317],[-75.5878007481829,6.263434181582497]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58780160201347,6.263434892913722],[-75.5878009964913,6.263435611087203]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58779490272718,6.263429311698317],[-75.587800813862,6.263434236300867]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58778936132569,6.263421694104849],[-75.58779638900859,6.26342754890895]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58780160201347,6.263434892913722],[-75.58780231763068,6.263434044162821]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58778383244427,6.263413531196406],[-75.58778443796642,6.263412813022896]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58778969230856,6.2634171904472],[-75.58778908678637,6.263417908620738]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58778936132569,6.263421694104849],[-75.58779112284412,6.2634196048719275]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58779131959759,6.263400540032407],[-75.58779092552186,6.263400211725411]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58779131959759,6.263400540032407],[-75.58779092552186,6.263400211725411]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58779092552186,6.263400211725411],[-75.58780066892244,6.263388655658602]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58779020304952,6.2633996098297615],[-75.58779994645008,6.263388053762995]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58780066892244,6.263388655658602],[-75.58782339395314,6.263407588017984]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58782339395314,6.263407588017984],[-75.5878089715183,6.263424693607604]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58782411642548,6.263408189913605],[-75.58780231763068,6.263434044162821]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58780055197225,6.263387335589385],[-75.5878247219471,6.2634074717400665]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58782411642548,6.263408189913605],[-75.5878247219471,6.2634074717400665]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58779994645008,6.263388053762995],[-75.58780055197225,6.263387335589385]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877910058945,6.263418284802768],[-75.5877952445486,6.2634132575880415]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58779172836631,6.263418886698361],[-75.58779536149876,6.263414577657144]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.5877952445486,6.2634132575880415],[-75.58779596702094,6.263413859483606]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58779995904818,6.26341840790316],[-75.58780830031702,6.263425357062772]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58779638900859,6.26342754890895],[-75.58779732481533,6.2634264390042915]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58779732481533,6.2634264390042915],[-75.5878032359507,6.263431363605747]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58780830031702,6.263425357062772],[-75.5878032359507,6.263431363605747]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.587800813862,6.263434236300867],[-75.58779563940118,6.263440373420025]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58779536149876,6.263414577657144],[-75.58779596702094,6.263413859483606]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58780056457036,6.26341768972965],[-75.58779995904818,6.26341840790316]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58780056457036,6.26341768972965],[-75.5878089715183,6.263424693607604]]}},{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[-75.58779092552186,6.263400211725411],[-75.58779131959759,6.263400540032407]]}}]}, // Ruta a tu archivo GeoJSON
      });

      map.addLayer({
        id: 'capa-planos',
        type: 'line',
        source: 'planos',
        layout: {
          'line-join': 'round',
          'line-cap': 'round'
        },
        paint: {
          'line-color': '#088', // Color azul para las líneas
          'line-width': 2 // Ancho de las líneas
        }
      });

      const geolocalizar = () => {
        if ('geolocation' in navigator) {
          navigator.geolocation.watchPosition(
            (position) => {
              const { latitude, longitude } = position.coords;
              actualizarUbicacion(longitude, latitude, map);
            },
            (error) => {
              console.error('Error al geolocalizar:', error);
            },
            { enableHighAccuracy: true }
          );
        } else {
          console.error('Geolocalización no disponible en este navegador.');
        }
      };
      geolocalizar();

      
    });

    return () => map.remove();
  }, []);

  // Función para actualizar la ubicación en el mapa
  const actualizarUbicacion = (longitude, latitude, map) => {
    console.log(longitude, latitude, map);
    if (map.getSource('ubicacion-usuario')) {
      // Actualizar las coordenadas de la fuente de datos GeoJSON existente
      map.getSource('ubicacion-usuario').setData({
        type: 'Point',
        coordinates: [longitude, latitude],
      });
    } else {
      // Crear una nueva fuente de datos GeoJSON y agregarla al mapa
      map.addSource('ubicacion-usuario', {
        type: 'geojson',
        data: {
          type: 'Point',
          coordinates: [longitude, latitude],
        },
      });
      map.addLayer({
        id: 'capa-ubicacion-usuario',
        type: 'circle',
        source: 'ubicacion-usuario',
        paint: {
          'circle-radius': 8,
          'circle-color': '#007bff',
        },
      });
    }
  };

  return <div ref={mapContainer} style={{ width: '100%', height: '500px' }} />;
};

export default Map;